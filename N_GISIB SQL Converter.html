<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GISIB SQL Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slide-up {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out;
        }
        .animate-slide-up {
            animation: slide-up 0.6s ease-out;
        }
        .animate-shake {
            animation: shake 0.5s ease-in-out;
        }
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        gisib: {
                            primary: '#014b6b',
                            dark: '#013249',
                            light: '#e0f2fe',
                        },
                        success: '#16a34a',
                    }
                },
            },
        }
    </script>
</head>
<body class="bg-gray-50 text-gray-800 antialiased">
    <div id="root"></div>
    <script type="text/babel">
        // Enums and Types
        const SqlOperator = {
            IN: 'IN',
            NOT_IN: 'NOT IN',
            EQUALS: '=',
            NOT_EQUALS: '<>',
            GREATER_THAN: '>',
            LESS_THAN: '<',
            BETWEEN: 'BETWEEN',
            LIKE: 'LIKE',
            IS_NULL: 'IS NULL',
            IS_NOT_NULL: 'IS NOT NULL',
        };

        // Icons Component
        const UploadIcon = () => (
            React.createElement('svg', {
                xmlns: "http://www.w3.org/2000/svg",
                width: "24",
                height: "24",
                viewBox: "0 0 24 24",
                fill: "none",
                stroke: "currentColor",
                strokeWidth: "2",
                strokeLinecap: "round",
                strokeLinejoin: "round"
            }, [
                React.createElement('path', { key: 'path1', d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" }),
                React.createElement('polyline', { key: 'polyline', points: "17 8 12 3 7 8" }),
                React.createElement('line', { key: 'line', x1: "12", y1: "3", x2: "12", y2: "15" })
            ])
        );

        const FileSpreadsheetIcon = () => (
            React.createElement('svg', {
                xmlns: "http://www.w3.org/2000/svg",
                width: "24",
                height: "24",
                viewBox: "0 0 24 24",
                fill: "none",
                stroke: "currentColor",
                strokeWidth: "2",
                strokeLinecap: "round",
                strokeLinejoin: "round"
            }, [
                React.createElement('path', { key: 'path1', d: "M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z" }),
                React.createElement('path', { key: 'path2', d: "M14 2v4a2 2 0 0 0 2 2h4" }),
                React.createElement('path', { key: 'path3', d: "M8 13h2" }),
                React.createElement('path', { key: 'path4', d: "M8 17h2" }),
                React.createElement('path', { key: 'path5', d: "M14 13h2" }),
                React.createElement('path', { key: 'path6', d: "M14 17h2" })
            ])
        );

        const DatabaseIcon = () => (
            React.createElement('svg', {
                xmlns: "http://www.w3.org/2000/svg",
                width: "24",
                height: "24",
                viewBox: "0 0 24 24",
                fill: "none",
                stroke: "currentColor",
                strokeWidth: "2",
                strokeLinecap: "round",
                strokeLinejoin: "round"
            }, [
                React.createElement('ellipse', { key: 'ellipse', cx: "12", cy: "5", rx: "9", ry: "3" }),
                React.createElement('path', { key: 'path1', d: "M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" }),
                React.createElement('path', { key: 'path2', d: "M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" })
            ])
        );

        const CopyIcon = () => (
            React.createElement('svg', {
                xmlns: "http://www.w3.org/2000/svg",
                width: "16",
                height: "16",
                viewBox: "0 0 24 24",
                fill: "none",
                stroke: "currentColor",
                strokeWidth: "2",
                strokeLinecap: "round",
                strokeLinejoin: "round"
            }, [
                React.createElement('rect', { key: 'rect', width: "14", height: "14", x: "8", y: "8", rx: "2", ry: "2" }),
                React.createElement('path', { key: 'path', d: "M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" })
            ])
        );

        const CheckIcon = () => (
            React.createElement('svg', {
                xmlns: "http://www.w3.org/2000/svg",
                width: "16",
                height: "16",
                viewBox: "0 0 24 24",
                fill: "none",
                stroke: "currentColor",
                strokeWidth: "2",
                strokeLinecap: "round",
                strokeLinejoin: "round"
            }, [
                React.createElement('polyline', { key: 'polyline', points: "20 6 9 17 4 12" })
            ])
        );

        const XIcon = () => (
            React.createElement('svg', {
                xmlns: "http://www.w3.org/2000/svg",
                width: "16",
                height: "16",
                viewBox: "0 0 24 24",
                fill: "none",
                stroke: "currentColor",
                strokeWidth: "2",
                strokeLinecap: "round",
                strokeLinejoin: "round"
            }, [
                React.createElement('path', { key: 'path1', d: "M18 6 6 18" }),
                React.createElement('path', { key: 'path2', d: "m6 6 12 12" })
            ])
        );

        // Excel Service Functions
        const parseExcelFile = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = e.target?.result;
                        if (!data) {
                            reject(new Error("Bestand is leeg"));
                            return;
                        }

                        const workbook = XLSX.read(data, { type: 'array' });
                        const sheetName = workbook.SheetNames[0];
                        if (!sheetName) {
                            reject(new Error("Geen werkbladen gevonden in het bestand."));
                            return;
                        }

                        const worksheet = workbook.Sheets[sheetName];
                        const rawData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        if (rawData.length === 0) {
                            reject(new Error("Werkblad is leeg."));
                            return;
                        }

                        const jsonData = XLSX.utils.sheet_to_json(worksheet);
                        const headers = jsonData.length > 0 ? Object.keys(jsonData[0]) : (rawData[0] || []);

                        resolve({
                            headers,
                            rows: jsonData,
                        });
                    } catch (error) {
                        reject(new Error(`Fout bij lezen Excel: ${error.message}`));
                    }
                };
                reader.onerror = () => reject(new Error("Fout bij lezen bestand"));
                reader.readAsArrayBuffer(file);
            });
        };

        const getUniqueValues = (rows, column) => {
            const values = new Set();
            rows.forEach(row => {
                const val = row[column];
                if (val !== undefined && val !== null && val !== '') {
                    values.add(String(val).trim());
                }
            });
            return Array.from(values).sort((a, b) => {
                const numA = parseFloat(a);
                const numB = parseFloat(b);
                if (!isNaN(numA) && !isNaN(numB)) {
                    return numA - numB;
                }
                return a.localeCompare(b, 'nl', { sensitivity: 'base' });
            });
        };

        // Debounce helper
        const debounce = (func, wait) => {
            let timeout;
            return (...args) => {
                clearTimeout(timeout);
                timeout = setTimeout(() => func(...args), wait);
            };
        };

        // ValueSelector Component
        const ValueSelector = ({ operator, uniqueValues, selectedValues, onSelectionChange, rangeStart, onRangeStartChange, rangeEnd, onRangeEndChange }) => {
            const [searchTerm, setSearchTerm] = React.useState('');

            // Debounced search
            const handleSearchChange = React.useCallback(
                debounce((value) => {
                    setSearchTerm(value);
                }, 300),
                []
            );

            // Filter unique values based on search term
            const filteredValues = React.useMemo(() => {
                if (operator !== SqlOperator.IN && operator !== SqlOperator.NOT_IN) {
                    return uniqueValues;
                }
                if (!searchTerm) return uniqueValues;
                return uniqueValues.filter(v => v.toLowerCase().includes(searchTerm.toLowerCase()));
            }, [uniqueValues, searchTerm, operator]);

            const toggleValue = React.useCallback((val) => {
                if (selectedValues.includes(val)) {
                    onSelectionChange(selectedValues.filter(v => v !== val));
                } else {
                    onSelectionChange([...selectedValues, val]);
                }
            }, [selectedValues, onSelectionChange]);

            const selectAll = React.useCallback(() => {
                onSelectionChange(filteredValues);
            }, [filteredValues, onSelectionChange]);

            const deselectAll = React.useCallback(() => {
                onSelectionChange([]);
            }, [onSelectionChange]);

            // Operators die geen waarden nodig hebben
            if (operator === SqlOperator.IS_NULL || operator === SqlOperator.IS_NOT_NULL) {
                return React.createElement('div', {
                    className: "text-gray-500 italic p-4 bg-gray-50 rounded-lg border text-center text-sm"
                }, `Geen waarden nodig voor ${operator}`);
            }

            // BETWEEN operator
            if (operator === SqlOperator.BETWEEN) {
                return React.createElement('div', { className: "space-y-4" }, [
                    React.createElement('div', { key: 'inputs', className: "grid grid-cols-1 md:grid-cols-2 gap-4" }, [
                        React.createElement('div', { key: 'start' }, [
                            React.createElement('label', { key: 'label1', className: "block text-sm font-medium text-gray-700 mb-2" }, "Vanaf waarde"),
                            React.createElement('input', {
                                key: 'input1',
                                type: "text",
                                value: rangeStart,
                                onChange: (e) => onRangeStartChange(e.target.value),
                                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gisib-primary focus:border-transparent outline-none transition",
                                placeholder: "Bijv. 100 of 2024-01-01"
                            })
                        ]),
                        React.createElement('div', { key: 'end' }, [
                            React.createElement('label', { key: 'label2', className: "block text-sm font-medium text-gray-700 mb-2" }, "Tot waarde"),
                            React.createElement('input', {
                                key: 'input2',
                                type: "text",
                                value: rangeEnd,
                                onChange: (e) => onRangeEndChange(e.target.value),
                                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gisib-primary focus:border-transparent outline-none transition",
                                placeholder: "Bijv. 500 of 2024-12-31"
                            })
                        ])
                    ]),
                    React.createElement('div', { key: 'tip', className: "text-xs text-gray-500 bg-blue-50 p-3 rounded-lg border border-blue-200" },
                        "ðŸ’¡ Tip: Gebruik getallen voor numerieke ranges of datums in YYYY-MM-DD formaat")
                ]);
            }

            // IN/NOT IN operators met multi-select
            if (operator === SqlOperator.IN || operator === SqlOperator.NOT_IN) {
                return React.createElement('div', { className: "space-y-4" }, [
                    React.createElement('div', { key: 'header', className: "flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3" }, [
                        React.createElement('label', { key: 'label', className: "block text-sm font-medium text-gray-700" },
                            `Selecteer waarden (${selectedValues.length} geselecteerd)`),
                        React.createElement('div', { key: 'buttons', className: "flex gap-2 text-sm" }, [
                            React.createElement('button', {
                                key: 'selectAll',
                                onClick: selectAll,
                                className: "text-gisib-primary hover:text-gisib-dark font-medium px-3 py-1 rounded border border-gisib-primary hover:bg-gisib-primary hover:text-white transition-colors"
                            }, "Alles"),
                            React.createElement('button', {
                                key: 'deselectAll',
                                onClick: deselectAll,
                                className: "text-gray-600 hover:text-gray-800 font-medium px-3 py-1 rounded border border-gray-300 hover:border-gray-400 transition-colors"
                            }, "Wissen")
                        ])
                    ]),
                    
                    // Search input
                    React.createElement('div', { key: 'search', className: "relative" }, [
                        React.createElement('input', {
                            key: 'input',
                            type: "text",
                            placeholder: "Zoek in waarden...",
                            onChange: (e) => handleSearchChange(e.target.value),
                            className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gisib-primary focus:border-transparent outline-none transition pr-10"
                        }),
                        React.createElement('div', { key: 'icon', className: "absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400" },
                            React.createElement('svg', { className: "w-4 h-4", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" },
                                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" }))
                        )
                    ]),

                    // Values list
                    React.createElement('div', { key: 'values', className: "border border-gray-300 rounded-lg max-h-80 overflow-y-auto bg-white shadow-inner custom-scrollbar" },
                        filteredValues.length === 0
                            ? React.createElement('div', { className: "p-6 text-center text-gray-500 text-sm" },
                                searchTerm ? `Geen waarden gevonden voor "${searchTerm}"` : 'Geen waarden beschikbaar')
                            : React.createElement('div', { className: "divide-y divide-gray-100" },
                                filteredValues.map((val) => {
                                    const isSelected = selectedValues.includes(val);
                                    return React.createElement('div', {
                                        key: val,
                                        onClick: () => toggleValue(val),
                                        className: `flex items-center p-3 cursor-pointer transition-colors ${
                                            isSelected ? 'bg-gisib-primary text-white' : 'hover:bg-gray-50 text-gray-700'
                                        }`
                                    }, [
                                        React.createElement('div', {
                                            key: 'checkbox',
                                            className: `w-5 h-5 mr-3 border rounded flex items-center justify-center ${
                                                isSelected ? 'bg-white border-white text-gisib-primary' : 'border-gray-400'
                                            }`
                                        }, isSelected ? React.createElement(CheckIcon) : null),
                                        React.createElement('span', { key: 'text', className: "text-sm truncate flex-1" }, val),
                                        isSelected && React.createElement('span', {
                                            key: 'badge',
                                            className: "text-xs bg-white text-gisib-primary px-2 py-1 rounded-full ml-2"
                                        }, "âœ“")
                                    ]);
                                })
                            )
                    ),

                    React.createElement('div', { key: 'footer', className: "flex justify-between items-center text-xs text-gray-500" }, [
                        React.createElement('span', { key: 'found' }, `${filteredValues.length} waarden gevonden`),
                        React.createElement('span', { key: 'selected' }, `${selectedValues.length} geselecteerd`)
                    ])
                ]);
            }

            // Single value operators (=, <>, >, <, LIKE)
            return React.createElement('div', { className: "space-y-3" }, [
                React.createElement('label', { key: 'label', className: "block text-sm font-medium text-gray-700" }, [
                    "Waarde",
                    operator === SqlOperator.LIKE && React.createElement('span', { key: 'hint', className: "text-xs text-gray-500 ml-2" }, "(gebruik % als wildcard)")
                ]),
                React.createElement('input', {
                    key: 'input',
                    type: "text",
                    value: selectedValues[0] || '',
                    onChange: (e) => onSelectionChange([e.target.value]),
                    className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gisib-primary focus:border-transparent outline-none transition",
                    placeholder: operator === SqlOperator.LIKE ? "bijv. %amsterdam%" :
                                operator === SqlOperator.GREATER_THAN ? "bijv. 100" :
                                operator === SqlOperator.LESS_THAN ? "bijv. 50" : "Voer waarde in..."
                }),
                operator === SqlOperator.LIKE && React.createElement('div', { key: 'tip', className: "text-xs text-gray-500 bg-yellow-50 p-3 rounded-lg border border-yellow-200" }, [
                    "ðŸ’¡ Voorbeelden: ",
                    React.createElement('br', { key: 'br1' }),
                    "â€¢ ",
                    React.createElement('code', { key: 'code1' }, "%amsterdam"),
                    " - eindigt op 'amsterdam'",
                    React.createElement('br', { key: 'br2' }),
                    "â€¢ ",
                    React.createElement('code', { key: 'code2' }, "amsterdam%"),
                    " - begint met 'amsterdam'",
                    React.createElement('br', { key: 'br3' }),
                    "â€¢ ",
                    React.createElement('code', { key: 'code3' }, "%amsterdam%"),
                    " - bevat 'amsterdam'"
                ])
            ]);
        };

        // Main App Component
        const App = () => {
            // State management
            const [file, setFile] = React.useState(null);
            const [excelData, setExcelData] = React.useState(null);
            const [isLoading, setIsLoading] = React.useState(false);
            const [error, setError] = React.useState(null);
            const [selectedColumn, setSelectedColumn] = React.useState('');
            const [selectedOperator, setSelectedOperator] = React.useState(SqlOperator.IN);
            const [selectedValues, setSelectedValues] = React.useState([]);
            const [rangeStart, setRangeStart] = React.useState('');
            const [rangeEnd, setRangeEnd] = React.useState('');
            const [generatedSql, setGeneratedSql] = React.useState('');
            const [copied, setCopied] = React.useState(false);
            const [isGenerating, setIsGenerating] = React.useState(false);

            // Derived state
            const uniqueColumnValues = React.useMemo(() => {
                if (!excelData || !selectedColumn) return [];
                return getUniqueValues(excelData.rows, selectedColumn);
            }, [excelData, selectedColumn]);

            // File upload handler
            const handleFileUpload = async (event) => {
                const uploadedFile = event.target.files?.[0];
                if (!uploadedFile) return;

                // Reset alles bij nieuwe upload
                setIsLoading(true);
                setError(null);
                setFile(uploadedFile);
                setExcelData(null);
                setSelectedColumn('');
                setSelectedValues([]);
                setRangeStart('');
                setRangeEnd('');
                setGeneratedSql('');

                try {
                    const data = await parseExcelFile(uploadedFile);
                    setExcelData(data);
                    if (data.headers.length === 0) {
                        setError("Geen kolommen gevonden in het bestand.");
                    }
                } catch (err) {
                    setError(err.message || "Onbekende fout bij inlezen bestand.");
                    setFile(null);
                } finally {
                    setIsLoading(false);
                }
            };

            // Column change handler
            const handleColumnChange = React.useCallback((e) => {
                const newColumn = e.target.value;
                setSelectedColumn(newColumn);
                setSelectedValues([]);
                setRangeStart('');
                setRangeEnd('');
                setGeneratedSql('');
                setError(null);
            }, []);

            // Operator change handler
            const handleOperatorChange = React.useCallback((e) => {
                const newOperator = e.target.value;
                setSelectedOperator(newOperator);
                setSelectedValues([]);
                setRangeStart('');
                setRangeEnd('');
                setGeneratedSql('');
                setError(null);
            }, []);

            // SQL Generation - VEILIG en STABIEL
            const generateSql = React.useCallback(async () => {
                // Reset en validation
                setError(null);
                setIsGenerating(true);
                
                try {
                    // Validatie
                    if (!selectedColumn) {
                        throw new Error("Selecteer eerst een kolom");
                    }
                    
                    // â­â­ AANGEPAST: Vierkante haken voor ArcGIS compatibiliteit â­â­
                    const col = `[${selectedColumn}]`;
                    
                    let sql = '';
                    const formatValue = (val) => {
                        const trimmed = val.trim();
                        if (!trimmed) throw new Error("Waarde mag niet leeg zijn");
                        return `'${trimmed.replace(/'/g, "''")}'`;
                    };

                    // Operator-specifieke logica
                    switch (selectedOperator) {
                        case SqlOperator.IN:
                        case SqlOperator.NOT_IN:
                            if (selectedValues.length === 0) {
                                throw new Error("Selecteer ten minste Ã©Ã©n waarde");
                            }
                            const inList = selectedValues.map(formatValue).join(', ');
                            sql = `${col} ${selectedOperator} (${inList})`;
                            break;
                            
                        case SqlOperator.BETWEEN:
                            if (!rangeStart.trim() || !rangeEnd.trim()) {
                                throw new Error("Vul beide tussenwaarden in");
                            }
                            const startVal = formatValue(rangeStart);
                            const endVal = formatValue(rangeEnd);
                            sql = `${col} BETWEEN ${startVal} AND ${endVal}`;
                            break;
                            
                        case SqlOperator.IS_NULL:
                        case SqlOperator.IS_NOT_NULL:
                            sql = `${col} ${selectedOperator}`;
                            break;
                            
                        default:
                            // Single value operators
                            if (selectedValues.length === 0 || !selectedValues[0]?.trim()) {
                                throw new Error("Vul een waarde in");
                            }
                            const val = selectedValues[0];
                            const formattedVal = selectedOperator === SqlOperator.LIKE ? formatValue(val) : `'${val.replace(/'/g, "''")}'`;
                            sql = `${col} ${selectedOperator} ${formattedVal}`;
                            break;
                    }

                    // Simuleer even verwerking (voorkom te snelle updates)
                    await new Promise(resolve => setTimeout(resolve, 100));
                    setGeneratedSql(sql);
                    
                } catch (err) {
                    setError(err.message || "Fout bij genereren SQL");
                    setGeneratedSql('');
                } finally {
                    setIsGenerating(false);
                }
            }, [selectedColumn, selectedOperator, selectedValues, rangeStart, rangeEnd]);

            // Copy to clipboard
            const copyToClipboard = React.useCallback(() => {
                if (!generatedSql) return;
                navigator.clipboard.writeText(generatedSql);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            }, [generatedSql]);

            // Clear error when user interacts
            const clearError = React.useCallback(() => {
                setError(null);
            }, []);

            // Can generate SQL?
            const canGenerateSql = React.useMemo(() => {
                if (!selectedColumn) return false;
                if (isGenerating) return false;

                switch (selectedOperator) {
                    case SqlOperator.IN:
                    case SqlOperator.NOT_IN:
                        return selectedValues.length > 0;
                    case SqlOperator.BETWEEN:
                        return rangeStart.trim() && rangeEnd.trim();
                    case SqlOperator.IS_NULL:
                    case SqlOperator.IS_NOT_NULL:
                        return true;
                    default:
                        return selectedValues.length > 0 && selectedValues[0]?.trim();
                }
            }, [selectedColumn, selectedOperator, selectedValues, rangeStart, rangeEnd, isGenerating]);

            return React.createElement('div', {
                className: "min-h-screen bg-gradient-to-br from-blue-50 to-gray-100 py-8 px-4 sm:px-6 lg:px-8"
            }, [
                React.createElement('div', { key: 'container', className: "max-w-4xl mx-auto space-y-8" }, [
                    // Header
                    React.createElement('div', { key: 'header', className: "text-center" }, [
                        React.createElement('div', { key: 'header-content', className: "flex items-center justify-center gap-4 mb-4" }, [
                            React.createElement('div', { key: 'icon', className: "bg-gisib-primary text-white p-3 rounded-2xl shadow-lg" },
                                React.createElement(DatabaseIcon)),
                            React.createElement('div', { key: 'text' }, [
                                React.createElement('h1', { key: 'title', className: "text-4xl font-bold text-gisib-primary" }, "GISIB SQL Converter"),
                                React.createElement('p', { key: 'subtitle', className: "mt-2 text-gray-600 text-lg max-w-2xl mx-auto" },
                                    "Genereer perfecte SQL queries direct vanuit je Excel data")
                            ])
                        ])
                    ]),

                    // Main Card
                    React.createElement('div', { key: 'main-card', className: "bg-white shadow-2xl rounded-3xl overflow-hidden border border-gray-200/50" }, [
                        // Step 1: Upload
                        React.createElement('div', { key: 'upload-section', className: "p-8 border-b border-gray-100 bg-white" }, [
                            React.createElement('div', { key: 'step-header', className: "flex items-center gap-3 mb-4" }, [
                                React.createElement('div', {
                                    key: 'step-number',
                                    className: "flex items-center justify-center w-8 h-8 bg-gisib-primary text-white text-sm font-bold rounded-full"
                                }, "1"),
                                React.createElement('label', { key: 'step-label', className: "block text-lg font-bold text-gray-800" }, "Upload Excel Bestand")
                            ]),
                            React.createElement('div', { key: 'upload-area', className: "relative group" }, [
                                React.createElement('input', {
                                    key: 'file-input',
                                    type: "file",
                                    accept: ".xlsx, .xls, .csv",
                                    onChange: handleFileUpload,
                                    className: "absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",
                                    disabled: isLoading
                                }),
                                React.createElement('div', {
                                    key: 'upload-ui',
                                    className: `border-3 border-dashed rounded-2xl p-12 text-center transition-all duration-300 ${
                                        file ? 'border-success bg-green-50/50' : 'border-gray-300 bg-gray-50/50 hover:border-gisib-primary hover:bg-blue-50/50'
                                    } ${isLoading ? 'animate-pulse cursor-not-allowed' : 'cursor-pointer'}`
                                }, React.createElement('div', { key: 'upload-content', className: "flex flex-col items-center justify-center gap-4" },
                                    isLoading ? [
                                        React.createElement('div', {
                                            key: 'spinner',
                                            className: "animate-spin rounded-full h-12 w-12 border-b-2 border-gisib-primary"
                                        }),
                                        React.createElement('div', { key: 'loading-text' }, [
                                            React.createElement('span', {
                                                key: 'loading-title',
                                                className: "font-semibold text-gisib-primary text-lg"
                                            }, "Bestand verwerken..."),
                                            React.createElement('p', { key: 'loading-subtitle', className: "text-sm text-gray-500 mt-1" },
                                                "Even geduld alstublieft")
                                        ])
                                    ] : file ? [
                                        React.createElement(FileSpreadsheetIcon, { key: 'file-icon' }),
                                        React.createElement('div', { key: 'file-text' }, [
                                            React.createElement('span', {
                                                key: 'file-name',
                                                className: "font-semibold text-success text-lg"
                                            }, file.name),
                                            React.createElement('p', { key: 'file-hint', className: "text-sm text-gray-500 mt-1" },
                                                "Klik om ander bestand te selecteren")
                                        ])
                                    ] : [
                                        React.createElement('div', { key: 'upload-icon', className: "p-4 bg-gisib-primary/10 rounded-2xl" },
                                            React.createElement(UploadIcon)),
                                        React.createElement('div', { key: 'upload-text' }, [
                                            React.createElement('span', {
                                                key: 'upload-title',
                                                className: "font-semibold text-gray-700 text-lg"
                                            }, "Klik of sleep je Excel bestand"),
                                            React.createElement('p', { key: 'upload-subtitle', className: "text-sm text-gray-400 mt-1" },
                                                "Ondersteunt .xlsx, .xls, .csv formaten")
                                        ])
                                    ]
                                ))
                            ]),

                            // File info
                            excelData && React.createElement('div', {
                                key: 'file-info',
                                className: "mt-6 p-4 bg-gradient-to-r from-gisib-primary to-gisib-dark text-white rounded-xl shadow-lg"
                            }, React.createElement('div', { className: "flex items-center justify-between" }, [
                                React.createElement('div', { key: 'info-left', className: "flex items-center gap-4" }, [
                                    React.createElement('div', { key: 'info-icon', className: "bg-white/20 p-2 rounded-lg" },
                                        React.createElement(FileSpreadsheetIcon)),
                                    React.createElement('div', { key: 'info-text' }, [
                                        React.createElement('div', { key: 'info-title', className: "font-semibold" }, "Bestand geladen"),
                                        React.createElement('div', { key: 'info-details', className: "text-sm opacity-90" },
                                            `${excelData.rows.length} rijen â€¢ ${excelData.headers.length} kolommen`)
                                    ])
                                ]),
                                React.createElement('div', { key: 'info-right', className: "text-right" }, [
                                    React.createElement('div', { key: 'count', className: "text-2xl font-bold" }, excelData.rows.length),
                                    React.createElement('div', { key: 'count-label', className: "text-sm opacity-90" }, "records")
                                ])
                            ]))
                        ]),

                        // Configurator Area
                        excelData && React.createElement('div', { key: 'configurator', className: "p-8 space-y-8" }, [
                            React.createElement('div', { key: 'selectors', className: "grid grid-cols-1 lg:grid-cols-2 gap-8" }, [
                                // Column Selection
                                React.createElement('div', { key: 'column-selector' }, [
                                    React.createElement('div', { key: 'column-header', className: "flex items-center gap-3 mb-4" }, [
                                        React.createElement('div', {
                                            key: 'column-step',
                                            className: "flex items-center justify-center w-8 h-8 bg-gisib-primary text-white text-sm font-bold rounded-full"
                                        }, "2"),
                                        React.createElement('label', {
                                            key: 'column-label',
                                            className: "block text-lg font-bold text-gray-800"
                                        }, "Kies Kolom")
                                    ]),
                                    React.createElement('div', { key: 'column-select', className: "relative" }, [
                                        React.createElement('select', {
                                            key: 'column-dropdown',
                                            value: selectedColumn,
                                            onChange: handleColumnChange,
                                            className: "w-full p-4 bg-white border-2 border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-3 focus:ring-gisib-primary/50 focus:border-gisib-primary appearance-none transition-all"
                                        }, [
                                            React.createElement('option', { key: 'default', value: "", disabled: true }, "-- Selecteer een kolom --"),
                                            ...excelData.headers.map((header) =>
                                                React.createElement('option', { key: header, value: header }, header)
                                            )
                                        ]),
                                        React.createElement('div', {
                                            key: 'dropdown-arrow',
                                            className: "absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-gray-500"
                                        }, React.createElement('svg', { className: "w-5 h-5 fill-current", viewBox: "0 0 20 20" },
                                            React.createElement('path', {
                                                d: "M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                            })))
                                    ])
                                ]),

                                // Operator Selection
                                React.createElement('div', { key: 'operator-selector' }, [
                                    React.createElement('div', { key: 'operator-header', className: "flex items-center gap-3 mb-4" }, [
                                        React.createElement('div', {
                                            key: 'operator-step',
                                            className: "flex items-center justify-center w-8 h-8 bg-gisib-primary text-white text-sm font-bold rounded-full"
                                        }, "3"),
                                        React.createElement('label', {
                                            key: 'operator-label',
                                            className: "block text-lg font-bold text-gray-800"
                                        }, "Kies Operator")
                                    ]),
                                    React.createElement('div', { key: 'operator-select', className: "relative" }, [
                                        React.createElement('select', {
                                            key: 'operator-dropdown',
                                            value: selectedOperator,
                                            onChange: handleOperatorChange,
                                            className: "w-full p-4 bg-white border-2 border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-3 focus:ring-gisib-primary/50 focus:border-gisib-primary appearance-none transition-all"
                                        }, Object.values(SqlOperator).map((op) =>
                                            React.createElement('option', { key: op, value: op }, op)
                                        )),
                                        React.createElement('div', {
                                            key: 'dropdown-arrow',
                                            className: "absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-gray-500"
                                        }, React.createElement('svg', { className: "w-5 h-5 fill-current", viewBox: "0 0 20 20" },
                                            React.createElement('path', {
                                                d: "M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                            })))
                                    ])
                                ])
                            ]),

                            // Step 4: Value Selector
                            selectedColumn && React.createElement('div', { key: 'value-selector', className: "animate-fade-in" }, [
                                React.createElement('div', { key: 'value-header', className: "flex items-center gap-3 mb-4" }, [
                                    React.createElement('div', {
                                        key: 'value-step',
                                        className: "flex items-center justify-center w-8 h-8 bg-gisib-primary text-white text-sm font-bold rounded-full"
                                    }, "4"),
                                    React.createElement('label', {
                                        key: 'value-label',
                                        className: "block text-lg font-bold text-gray-800"
                                    }, "Configureer Waarden")
                                ]),
                                React.createElement('div', {
                                    key: 'value-container',
                                    className: "p-6 bg-gray-50 rounded-2xl border-2 border-gray-200"
                                }, React.createElement(ValueSelector, {
                                    operator: selectedOperator,
                                    uniqueValues: uniqueColumnValues,
                                    selectedValues: selectedValues,
                                    onSelectionChange: setSelectedValues,
                                    rangeStart: rangeStart,
                                    onRangeStartChange: setRangeStart,
                                    rangeEnd: rangeEnd,
                                    onRangeEndChange: setRangeEnd
                                }))
                            ]),

                            // Error Message
                            error && React.createElement('div', {
                                key: 'error',
                                className: "p-4 bg-red-50 border-2 border-red-200 rounded-xl animate-shake"
                            }, [
                                React.createElement('div', { key: 'error-content', className: "flex items-center gap-3" }, [
                                    React.createElement('div', { key: 'error-icon', className: "flex-shrink-0" },
                                        React.createElement(XIcon)),
                                    React.createElement('div', { key: 'error-message', className: "flex-1" },
                                        React.createElement('p', { className: "text-red-800 font-medium" }, error)),
                                    React.createElement('button', {
                                        key: 'error-close',
                                        onClick: clearError,
                                        className: "flex-shrink-0 text-red-600 hover:text-red-800 transition-colors"
                                    }, React.createElement(XIcon))
                                ])
                            ]),

                            // Generate Button
                            React.createElement('button', {
                                key: 'generate-button',
                                onClick: generateSql,
                                disabled: !canGenerateSql,
                                className: `w-full py-4 px-6 rounded-xl font-bold text-white shadow-lg transition-all transform ${
                                    !canGenerateSql ? 'bg-gray-300 cursor-not-allowed' : 'bg-gradient-to-r from-success to-green-600 hover:from-green-600 hover:to-green-700 hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-xl'
                                } ${isGenerating ? 'animate-pulse' : ''}`
                            }, isGenerating
                                ? React.createElement('div', { className: "flex items-center justify-center gap-3" }, [
                                    React.createElement('div', {
                                        className: "animate-spin rounded-full h-5 w-5 border-b-2 border-white"
                                    }),
                                    React.createElement('span', null, "Bezig met genereren...")
                                ])
                                : 'Genereer SQL Query'
                            )
                        ])
                    ]),

                    // Output Area
                    generatedSql && React.createElement('div', {
                        key: 'output',
                        className: "bg-white shadow-2xl rounded-3xl p-8 border border-gray-200/50 animate-slide-up"
                    }, [
                        React.createElement('div', {
                            key: 'output-header',
                            className: "flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6"
                        }, [
                            React.createElement('h3', {
                                key: 'output-title',
                                className: "font-bold text-gray-800 text-xl flex items-center gap-3"
                            }, [
                                React.createElement(CheckIcon, { key: 'icon' }),
                                "SQL Query Gegenereerd"
                            ]),
                            React.createElement('button', {
                                key: 'copy-button',
                                onClick: copyToClipboard,
                                className: `flex items-center gap-3 px-6 py-3 rounded-xl font-semibold transition-all shadow-lg ${
                                    copied ? 'bg-green-100 text-green-700 border-2 border-green-200' : 'bg-gisib-primary text-white hover:bg-gisib-dark transform hover:scale-105'
                                }`
                            }, [
                                copied ? React.createElement(CheckIcon, { key: 'copy-icon' }) : React.createElement(CopyIcon, { key: 'copy-icon' }),
                                copied ? 'Gekopieerd!' : 'Kopieer naar klembord'
                            ])
                        ]),
                        React.createElement('div', {
                            key: 'sql-output',
                            className: "bg-gisib-dark text-gray-100 p-6 rounded-xl font-mono text-lg overflow-x-auto border-2 border-gray-700 shadow-inner"
                        }, React.createElement('code', null, generatedSql)),
                        React.createElement('div', {
                            key: 'output-tip',
                            className: "mt-6 p-4 bg-blue-50 rounded-xl border-2 border-blue-200"
                        }, [
                            React.createElement('div', {
                                key: 'tip-content',
                                className: "flex items-center gap-3 text-blue-700"
                            }, [
                                React.createElement('svg', {
                                    key: 'tip-icon',
                                    className: "w-5 h-5 flex-shrink-0",
                                    fill: "currentColor",
                                    viewBox: "0 0 20 20"
                                }, React.createElement('path', {
                                    fillRule: "evenodd",
                                    d: "M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",
                                    clipRule: "evenodd"
                                })),
                                React.createElement('div', { key: 'tip-text', className: "text-sm" }, [
                                    React.createElement('strong', { key: 'strong' }, "Klaar voor gebruik!"),
                                    " Plak deze query in ArcGIS Pro \"Select By Attributes\" of gebruik hem in je GIS applicatie."
                                ])
                            ])
                        ])
                    ]),

                    // Footer
                    React.createElement('div', { key: 'footer', className: "text-center text-gray-500 text-sm" },
                        "Ahmad & Bjorn")
                ])
            ]);
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
